<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>govtech-agent</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    <script type="module">
      document.cookie =
        "chatbotDisclaimer=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/";

      import Chatbot from "https://cdn.jsdelivr.net/gh/tshering314/GovTechChatEmbed@latest/dist/web.js";
      Chatbot.init({
        chatflowid: "a9d6d456-4b27-4805-8f03-532560d9700c",
        apiHost: "https://chatbot.tech.gov.bt",
        theme: {
          disclaimer: {
            title: "Disclaimer",
            message: `<p style="text-align:justify">Responses are generated automatically by AI based on your input, and we cannot guarantee that the information will be complete, accurate, or up-to-date.
        <br/>Accordingly, the information provided by the Chatbot should not be considered as a basis for production workloads.
        <br/>You are solely responsible for the interactions and reliance on the information provided by the Chatbot, as well as for any actions taken or not taken.
        <br/><b>AI-generated content may be inaccurate. Please validate before making decisions.</b></p>`,
            textColor: "black",
            buttonColor: "#3b82f6",
            buttonText: "Start Chatting",
            buttonTextColor: "white",
            blurredBackgroundColor: "rgba(0, 0, 0, 0.4)", //The color of the blurred background that overlays the chat interface
            backgroundColor: "white",
            denyButtonText: "Cancel",
            denyButtonBgColor: "#ef4444",
          },
          chatWindow: {
            welcomeMessage: `Hello, I am Chidrel, the AI Assistant of the Ministry of Foreign Affairs and External Trade of Bhutan. I am continually learning, and your interactions help me improve. If you have any suggestion, 
        please <a href="https://forms.gle/UdNZJKw5gkgvb7qY8">click here</a> to submit`,
            showTitle: true,
            title: "Chidrel",
            titleAvatarSrc:
              "https://tech.gov.bt/wp-content/uploads/2025/09/logo.png",
            botMessage: {
              showAvatar: true,
              avatarSrc:
                "https://www.mfa.gov.bt/wp-content/uploads/2026/01/Screenshot-7.png",
            },
            footer: {
              textColor: "#303235",
              text: "Powered by",
              company: "Govtech Bhutan",
              companyLink: "https://tech.gov.bt",
            },
            renderHTML: true,
          },
        },
        observersConfig: {
          // The bot message stack has changed
          observeMessages: (messages) => {
            const messageIndex = messages.findIndex((msg) => msg.action);

            if (messageIndex > -1) {
              setTimeout(() => {
                const chatbotHost = document.querySelector("flowise-chatbot");

                if (chatbotHost && chatbotHost.shadowRoot) {
                  const shadowRoot = chatbotHost.shadowRoot;
                  const buttonNodes = shadowRoot.querySelectorAll("button");
                  const buttons = Array.from(buttonNodes);

                  if (buttons.length) {
                    buttons?.forEach((btn) => {
                      if (btn.innerText.includes("Proceed"))
                        btn.innerText = " Yes";
                      if (btn.innerText.includes("Reject"))
                        btn.innerText = " No";
                    });
                  }
                }
              }, 400);
            }
          },
        },
      });
    </script>
  </body>
</html>
